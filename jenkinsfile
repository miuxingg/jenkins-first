pipeline{
    agent any
    triggers {
        pollSCM('*/3 * * * *') 
    }
    stages{
        // stage("Node modules update"){
        //     steps{
        //         sh "curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/master/install.sh"
        //         sh "source ~/.bashrc"
        //         sh "nvm install v16"
        //         sh "nvm use 16.10.0"
        //         sh "yarn"
        //     }
        // }

        stage("Build docker image"){
            steps{
                sh 'docker build -t jenkis-nest .'
            }
            
        }
        stage("Run docker image"){
            steps{
               sh 'docker run -p 7000:7000 jenkis-nest'
            }
            
        }
        
    }
    post{
        success{
            echo "========pipeline executed successfully ========"
        }
        failure{
            echo "========pipeline execution failed========"
        }
    }
}